/*! angularjs-utilities - v0.0.1 - 2015-02-09 */

!function(){"use strict";angular.module("ca.axoninteractive.AngularJS.Utilities",["ui.bootstrap","ui.router"])}(),function(){"use strict";var app=angular.module("ca.axoninteractive.AngularJS.Utilities");app.directive("compile",function($compile){return function(scope,element,attrs){scope.$watch(function(scope){return scope.$eval(attrs.compile)},function(value){element.html(value),$compile(element.contents())(scope)})}})}(),function(){"use strict";var app=angular.module("ca.axoninteractive.AngularJS.Utilities");app.directive("errorMessage",["$errorMessage","$sce",function($errorMessage,$sce){return{scope:{phrasing:"=phrasing"},restrict:"AE",templateUrl:"directives/errorMessage/errorMessage.html",transclude:!0,link:function($scope){$scope.onCloseButtonClicked=function(){$scope.isCollapsed=!0},$scope.onShowErrorClicked=function(){$scope.showError=!$scope.showError,$scope.showErrorText=$scope.showError?"Hide details...":"Show details...",$scope.showError&&($scope.errorText=$sce.trustAsHtml($scope.phrasing.error))},function(){$scope.explanation=$sce.trustAsHtml($errorMessage.getExplanation($scope.phrasing)),$scope.supportInvitation=$sce.trustAsHtml($errorMessage.getSupportInvitation($scope.phrasing)),$scope.mergedPhrasing=$errorMessage.getPhrasingMerged($scope.phrasing),$scope.showError=!1,$scope.showErrorText="Show details...",$scope.errorText="",$scope.isCollapsed=!1}()}}}])}(),function(){"use strict";var app=angular.module("ca.axoninteractive.AngularJS.Utilities");app.filter("TruncateText",[function(){return function(inputStr,isWordwise,maxNumChars,suffixStr){if(!inputStr)return"";if(maxNumChars=parseInt(maxNumChars,10),!maxNumChars)return inputStr;if(inputStr.length<=maxNumChars)return inputStr;if(inputStr=inputStr.substr(0,maxNumChars),isWordwise){var lastspace=inputStr.lastIndexOf(" ");-1!==lastspace&&(inputStr=inputStr.substr(0,lastspace))}return inputStr+(suffixStr||" â€¦")}}])}(),function(){"use strict";var app=angular.module("ca.axoninteractive.AngularJS.Utilities");app.factory("$errorMessage",[function(){var defaultPhrasing={email:"theteam@axoninteractive.ca",error:"",noun:"the requested action",title:"Something went wrong...",verb:"complete",verbPresent:"completing",createExplanation:function(phrasing){return"We encountered a problem while "+phrasing.verbPresent+" "+phrasing.noun+". This may be because no internet connection is available, or because of an internal server error. Check that your internet connection is working properly and try again."},createSupportInvitation:function(phrasing){return"If you are unable to "+phrasing.verb+" "+phrasing.noun+' after several tries, feel free to contact our website administrator at <a href="mailto:'+phrasing.email+'">'+phrasing.email+"</a> so we can resolve this issue for you."}},getExplanation=function(userPhrasing){var mergedPhrasing=defaultPhrasing;return userPhrasing&&angular.extend(mergedPhrasing,userPhrasing),defaultPhrasing.createExplanation?defaultPhrasing.createExplanation(mergedPhrasing):void 0},getPhrasingCopy=function(){return angular.copy(defaultPhrasing)},getPhrasingMerged=function(userPhrasing){return angular.extend(defaultPhrasing,userPhrasing)},getSupportInvitation=function(userPhrasing){var mergedPhrasing=defaultPhrasing;return userPhrasing&&angular.extend(mergedPhrasing,userPhrasing),defaultPhrasing.createSupportInvitation?defaultPhrasing.createSupportInvitation(mergedPhrasing):void 0};return{defaultPhrasing:defaultPhrasing,getExplanation:getExplanation,getPhrasingCopy:getPhrasingCopy,getPhrasingMerged:getPhrasingMerged,getSupportInvitation:getSupportInvitation}}])}(),function(){"use strict";var app=angular.module("ca.axoninteractive.AngularJS.Utilities");app.factory("$navigationListener",["$window","$modal","$state",function($window,$modal,$state){function onBeforeUnload(event){return event.returnValue=message,message}function onStateChange(event,newTargetState){isNavigationApprovedByUser||(event.preventDefault(),targetState=newTargetState,$modal.open({templateUrl:"views/__Modals/GenericModal/GenericModal.html",controller:"GenericModalController",resolve:{$modalArgs:function(){return{showCancelButton:!0,onOkayButtonClicked:onModalUnsavedOkayButtonClicked,onCancelButtonClicked:onModalUnsavedCancelButtonClicked,title:"Are you sure?",message:"<p>"+message+"</p>"}}}}))}function onModalUnsavedOkayButtonClicked(modalInstance){modalInstance.close(),isNavigationApprovedByUser=!0,self.stopListening(),$state.go(targetState)}function onModalUnsavedCancelButtonClicked(modalInstance){modalInstance.close(),isNavigationApprovedByUser=!1}function isListening(){return!!deregisterFunc}var self={};self.startListening=function($scope,errorMessage){return isListening()?void 0:(angular.isString(errorMessage)&&(message=errorMessage),deregisterFunc=$scope.$on("$stateChangeStart",onStateChange),$window.addEventListener("beforeunload",onBeforeUnload))},self.stopListening=function(){message=DEFAULT_MESSAGE,isListening()&&(deregisterFunc(),deregisterFunc=angular.noop,$window.removeEventListener("beforeunload",onBeforeUnload))};var isNavigationApprovedByUser,deregisterFunc,message,targetState,DEFAULT_MESSAGE="You are attempting to navigate away from a page where you could potentially lose unsaved changes.";return function(){isNavigationApprovedByUser=!1,message=DEFAULT_MESSAGE}(),self}])}(),function(){"use strict";var app=angular.module("ca.axoninteractive.AngularJS.Utilities");app.controller("GenericModalController",["$scope","$state","$modalInstance","$modalArgs","$sce",function($scope,$state,$modalInstance,$modalArgs,$sce){$scope.onOkayButtonClicked=function(){return"function"!=typeof $modalArgs.onOkayButtonClicked?void $modalInstance.close():void $modalArgs.onOkayButtonClicked($modalInstance)},$scope.onCancelButtonClicked=function(){return"function"!=typeof $modalArgs.onCancelButtonClicked?void $modalInstance.close():void $modalArgs.onCancelButtonClicked($modalInstance)},function(){if("undefined"==typeof $modalArgs)throw new Error("A generic modal requires $modalArgs to be set.");$scope.title=$modalArgs.title,$scope.message=$sce.trustAsHtml($modalArgs.message),$scope.showCancelButton=$modalArgs.showCancelButton}()}])}();